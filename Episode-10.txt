ジャック: ジェームズ・ボンドを想像してみてください。[音楽] ボンドが任務に向かう前に、彼はQから重要な装備を受け取ります。ある任務では、彼は超高周波を発することができる特別な指輪を手に入れました。
これを窓にかざすと、ガラスを粉砕することができます。この任務で、ボンドは北朝鮮に気付かれずに進入しましたが、もし彼が指輪を北朝鮮で失くしたら、どのような結果を招くでしょうか？
北朝鮮政府がその指輪を見つければ、それを分析し、最先端技術を発見し、それを自国で再現することができるかもしれません。これは本来渡してはいけない相手に技術を渡すことになるのです。
さらに、指輪を分析する際に、MI5に由来するものであることを突き止めるかもしれません。つまり、その指輪を発見するだけで、北朝鮮は自国に英国のスパイがいることを推測できるのです。
これは多数の問題を引き起こし、場合によっては戦争をも招くかもしれません。政府が他国をハッキングするようなインターネットの世界では、敵に自分の存在を知られたり、ハッキング手法を捕捉されたりしないことがとても重要です。
なぜなら、もしそうなれば破滅的な結果を招く可能性があるからです。
ジャック（イントロ）: [イントロ音楽] これは「Darknet Diaries」、インターネットの暗黒面からの真実の物語です。私はジャック・リサイダーです。[イントロ音楽終了]
ジャック: 皆さん、皆さん、聞いてください。このエピソードは非常に深刻です。他のエピソードが子供の遊びのように思えるほどです。これを話すのに緊張しています。今はまだFBIの監視リストには載っていないと思いますが、
このエピソードの後には載るかもしれません。では、お聞きしますが、世界で最も洗練されたハッキングチームはどこでしょうか？それはMITやカーネギーメロン大学の卒業生で構成されたチームで、
最先端のハッキングツールを作成したチームです。ほぼ無限のリソースを利用できるチームです。
例えば、言語通訳、大規模データセンター、スーパーコンピューターなどのリソース。暗号化メソッドを作成しインターネットを構築してきた歴史を持つチームです。
そう、政府機関内部にいるハッキンググループ、つまり国家支援のハッカー集団（Nation State Actors）です。彼らの活動のほとんどは極秘とされており、このショーで彼らの一人と話すことができたのは非常に特別な特権です。
国家支援のハッカーは例外的なハッカー集団です。彼らは基本的にハッキングのライセンスを持っています。法的な報復を恐れずに活動します。
彼らはしばしば秘密を盗むか、接続されたネットワークを介してターゲットを混乱させる任務を与えられます。彼らのすべての活動が完全にレーダーの下で行われ、ターゲットに見えないままであることが重要です。
どのようにしてこれを見つけたか、誰なのかは聞かないでください。しかし今回のエピソードでは、世界で最もエリートなハッキングチームの最深部にいた人物の話を聞くことになります。
NSA: はい、私はアメリカ政府で約15年間、攻撃的なサイバー作戦を指揮してきたので、多くの話があります。
ジャック: 彼がこの番組のインタビューに応じる条件として、匿名を維持し、声を変えるというものがありました。
したがって、皆さんが聞くのは、彼との会話の書き起こしを声優が読み上げたものです。彼の話が本当かどうか疑問に思うかもしれませんが、私が知っていることをお伝えします。
私は10年以上にわたり情報セキュリティのプロフェッショナルとして働いてきました。ある時、雇用主によって脅威インテリジェンストレーニングに送られました。
そこで、最も洗練されたハッカーが使用するさまざまな戦術、技術、手順を学びました。この人物の話を聞いていると、彼が使用する戦術、技術、手順が、私が授業で学んだことと完全に一致しました。
その部分については本当だと保証できますが、残りのストーリーについては分かりません。判断は皆さんにお任せします。
[音楽] ただし、いくつかの追加情報が必要です。ほぼすべての政府がインテリジェンス部門を持っています。アメリカには中央情報局（CIA）や国家安全保障局（NSA）などがあります。
インテリジェンス部門の目的は、国に対する脅威に関する敵の情報を入手することです。これは国家安全保障の名のもとに行われており、要するに、政府はお互いにスパイ活動を行っているのです。
これは皆さんにとって驚くべきことではないでしょう。何世紀も前から続いています。かつてスパイたちは潜入して物理的に機密データを盗み出していました。
彼らは高度に訓練され、ステルスで逃げ隠れする能力を持ち、運転技術も優れていました。しかし今や、政府はコンピュータを使ってコミュニケーションを取り、データを保存し、計画を作成しています。
[00:05:00] これは全く新しい攻撃対象領域を露呈しています。ドキュメントを盗むために物理的に建物に侵入する代わりに、ハッカーは地球の反対側からドキュメントを盗むことができます。
これは、今後の攻撃について学ぶため、軍の動きを知るため、または極秘兵器の計画を盗むために行われます。政府は積極的に他の政府にハッキングを行っています。これが新たな常態です。
政府は、他の政府からデータを守るために、サイバー防御を真剣に考えなければなりません。しかし、ある政府が他の政府にハッキングを行うとき、実際にはどのようなことが起こるのでしょうか？これがこれから聞く物語です。
国家支援のハッカーが他の政府にハッキングする様子を並走して見ていきましょう。これはエキサイティングなはずですので、安全ベルトを締めて、出発しましょう。まずは任務を確認します。
NSA: 数年前、ある外国の政府機関のネットワークを標的にする任務が与えられました。我々の任務は、それにアクセスし、特定の情報を収集することでした。
国家支援の作戦が進行する方法としては、国家のサイバー要素が独自に要求を立てるのではなく、政府内や機関内の他者から要求を受けます。
我々はそのネットワークにその情報があると考えて、アクセスしに行くように指示されるのですが、通常、それだけが任務です。
ジャック: この任務にはほんのわずかな情報しかありません。外国の政府機関の名前、いくつかのIPアドレス、そして取得すべきデータの一般的なアイデアが与えられるだけです。
それだけではそのネットワークにハッキングを開始するには全く不十分です。使用するべきツールも、侵入後にどのコンピュータを標的にすべきかもわかりません。もっと情報が必要です。
NSA: 実際、特に国家のために大事なことは、もちろん情報を入手して収集することが目標ですが、それを超える目標があります。それは、秘密を保ち続けることです。
ジャック: より多くの情報が必要であるだけでなく、それを秘密裏に取得する必要があります。この任務を行う際に隠密行動を取る理由は多くあります。まず…
NSA: 政治的な反発があるかもしれません。
ジャック: 他国が私たちがハッキングを行っていることを知れば激怒する可能性があります。また、捕まらない理由としては、私たちのツール、エクスプロイト、インフラストラクチャの価値があるためです。
ジェームズ・ボンドが彼の極秘スパイ技術を失うわけにはいかないのと同様に、国家支援のハッカーも、ターゲットに知られたくない最先端のハッキング手法を使用しています。
これらのハッキング手法は非常に高価で、時には数年にわたる研究が必要であり、数百万ドルの価値があります。この任務全体を通じて可能な限り目立たないようにすることが不可欠です。
さて、この物語では例として使用するターゲット国をランダムに選びましょう。
NSA: ペルー外務省にしましょう。
ジャック: 実際のターゲットは匿名のままにします。軍は攻撃がどのように行われるかを説明するために「キルチェーン」という用語を使うことがあります。
NSA: 軍ではこれを「戦場の準備」と呼びますが、サイバーにおいては…
ジャック: サイバーキルチェーンです。これはサイバー攻撃のさまざまな段階を説明するものです。この物語を進めていく中で、その意味を説明していきます。
攻撃を完遂するためには、サイバーキルチェーンの7つの段階が実行されなければなりません。第一段階は偵察です。[音楽] この段階ではターゲットに関する情報を収集する必要があります。
述べたように、どの種類のエクスプロイトを使用するか、どのシステムを攻撃するか全くわからないので、情報収集から始めます。
NSA: さて、どうやって侵入するかを考えなければなりません。つまり、パッシブ偵察やネットワークのマッピングを始めます。ターゲットにこちらが情報を集めていることを知らせずに、
このネットワークについて何を学べるかを考え始めます。たとえば、ネットワークの規模はどれくらいか？どんな種類のシステムが存在するのか？
ハードウェアやソフトウェアは？どんなアンチウイルスが導入されているのか？アクセス経路は何か？などの質問をします。
ジャック: チームはターゲットネットワークに対してスキャンを実施し、インターネットに露出しているものを調べます。彼らは世界に見えるものをマップし始めます。
NSA: 彼らにはウェブサイトがあります。その環境内にウェブサーバーをホストしています。インターネット上のサーバーで、例えばApache Tomcatが稼働しています。
なるほど、これは知っておくと良い情報です。おそらくLinuxのサーバーで、潜在的にエクスプロイトできる脆弱性を持つウェブサーバーであると分かります。これは非常に興味深いですね。このようなものがいくつか見つかります。
ジャック: 通常、ほとんどの政府や組織はインターネットに接続するデバイスを最新の状態に保ちます。なぜなら、システムが古いと、更新されているものに比べて多くのセキュリティホールがあるからです。
しかし、このケースではウェブサーバーが完全にパッチされていませんでした。つまり、チームはそれを利用して既知の脆弱性を使ってアクセスできるということです。
NSA: いくつかの潜在的な侵入経路を考え始めます。
ジャック: これで、この政府のネットワークに侵入するための潜在的な入口が見つかりましたが、それでもまだ情報が不足しています。そのネットワーク内に実際に何があるのかを理解しようとすることが重要であり、
一度侵入した後に移動する道筋のマップがあれば便利です。また、そのオフィスで働いている人々を知って、そのネットワークを守っているチームの雰囲気を掴めればさらに良いです。
これを見つけ出すためのトリッキーな方法がいくつかあります。
NSA: その方法は、ITと情報セキュリティの人々は概してフレンドリーでオープン、そして時には少し間抜けである、ということに基づいています。[00:10:00] 
ペルー外務省を例に挙げれば、FacebookやLinkedIn、またはペルー現地のFacebookのようなものを通じて、その組織で働く50から100人、多くて数百人のプロフィールを見つけられるでしょう。
そこで働く人々のフルネームやメールアドレス、場合によっては役職名まで収集し始めることができます。私が関心を持っているのはITインフラ、技術インフラなので、IT担当者やセキュリティ担当者を探しています。
その組織でITを担当しているシステム管理者やデータベース管理者などをインターネット上で見つけられると確信しています。
これは彼らの名前とメールアドレスであり、彼らがその組織で何をしているかです。これらすべてをまとめ始めたら、彼らをその組織や使用しているものに関連付ける方法を探し始めます。
これを行う最良の場所はGoogleですが、もっと具体的にはRedditが驚くほど役立ちます。そして製品に関する技術フォーラムもです。例えば、LinkedInやFacebookでBobがペルー外務省のIT管理者だとわかったとします。
これでBobのフルネームとメールアドレスが手に入ります。次にGoogleで彼の名前とメールアドレスを検索できます。すると、Bobがこのsysadminのsubredditに投稿した、
彼のWindows 2012サーバーがなぜこのように動作しているのかという質問や、「Windows 2008 R2ボックスを実行しているんですが、これが私のドメインコントローラーです。
アップデートする必要が本当にあるのでしょうか？正直言ってしたくないのですが、皆さんどう思いますか？」という質問が見つかります。そのような投稿を見つけると、それをBobにリンクさせることができるのです。
「なんてこった、彼らはWindows 2008 R2ボックスでドメインコントローラーを動かしているぞ。」といったことを確認することができます。これらはアンチウイルスやセキュリティのフォーラムでも見つかります。
ジャック: 我々の目標はネットワークから特定のデータを取得することなので、そのデータはどこかのデータベースに存在する可能性があります。
そこでチームはそこに働く人々に目を向け、データベース管理者、つまりDBAを見つけようとします。
NSA: FacebookやLinkedInでDBAを見つけました。彼はシニアDBAで、Oracle 11gの専門家であることが記載されています。クールですね。
これで、彼らがネットワーク内でおそらくOracle 11gを実行していると仮定できます。私のチームには15人ほどのメンバーがいます。彼らは1日8時間、6〜8週間にわたって、ターゲット組織で働く人々の名前やメールアドレス、
電話番号を調べて収集することに専念しています。その数を、特定の役割で働いている人々に絞り込み、インターネットで公開されている技術に関するすべての情報をくまなく探します。
これにより、その環境で何が期待できるかについての小さな手がかりが得られます。
ジャック: [音楽] これまでに収集したデータを見た結果、非常に重要な情報を発見しました。
NSA: 彼らの環境にあるOracleデータベースには、私が集めることになっているデータがある可能性が高いことがわかりました。
ジャック: 15人が2か月にわたってフルタイムでターゲットに関するできるだけ多くの情報を集めた結果、非常に詳細な報告書が完成しました。
誰が働いているのか、彼らの役割、どのようなシステムを使用しているのか、そのシステム上のソフトウェアのバージョンまで把握しました。これで彼らの環境の全体像をかなり良く把握できました。素晴らしいですね。
これでフェーズ1が完了しました。次に、サイバーキルチェーンのフェーズ2、「武器化」に移ります。
NSA: これで、指導層、管理層、つまり私が今使おうとしている権利を表向きには所有している人たちのところに行き、これから行うことについての承認を求めることができます。
ジャック: ここで言う「権利」とは、ネットワークにアクセスするために使われるハッキング技術やエクスプロイトのことです。あるハッキング技術は公に知られており、取得にコストがかからないため、承認を得やすいです。
また、そのエクスプロイトを使用しても、世界中の誰もがそれを利用できるため、追跡して私たちに辿り着くことは困難です。しかし、いくつかのエクスプロイトは高価で極秘です。
これらは承認を得るのが難しく、なぜなら、もし捕まった場合、敵があなたのエクスプロイトの使い方を学ぶかもしれず、世界の誰もが知らないエクスプロイトを使用して捕まった場合、
それを所有している可能性のある人が限られ、それが原因で今回の不正侵入が私たちに追跡される可能性があるからです。
NSA: 指導層に行って、このネットワークを標的にする任務をこれらの人々から受けました。これがネットワークについて知っているすべてです。これがシステム管理者で、これがセキュリティ担当者、
これが名前、メールアドレス、電話番号です。データポイント a、b、c、d、e に基づいて、彼らがこの種のアンチウイルスとこの種のハードウェアを使用していると信じています。
彼らがTomcatを使用してウェブサーバーを運用していることがわかっています。いくつかのフォーラムへの投稿に基づいて、内部にOracleデータベースのインスタンスを持っていることがわかっていますので、
すべてをまとめて、そのデータポイントを基に必要なツールやエクスプロイトを導き出します。
知っていることを考慮して、[00:15:00] 侵入する前に、Oracle 11gに特化したエクスプロイトYを伴ったインプラントXを使用する承認を得ることができます。
この計画を立てたら、環境について知っていることを考慮し、その権利に対するリスクに基づき承認を得ることができます。
彼らが恐らくこのアンチウイルスやセキュリティツールを使っていることを知っていると言うとき、そのアンチウイルスやセキュリティシステムに検出されないツールやエクスプロイトをネットワークに展開すると言えます。
私は今、最大のリスクであるAV（アンチウイルス）やセキュリティシステムがツールやエクスプロイトを警告するリスクを軽減しました。それができれば、実際に作戦を実行するための承認を得ることができます。
60日、90日が過ぎて、ターゲティングパッケージが完成し、その任務を完遂するために承認を受けました。
ジャック: 今や侵入ポイント、内部の地図、到着時にそこに誰がいるかを知っています。そして、この任務を実行するために必要な特定のエクスプロイトもすべて揃っています。
これで武器化フェーズが終わります。サイバーキルチェーンのフェーズ3であるデリバリー（配信）に移ります。これでネットワーク内のシステムに実際にエクスプロイトを送信する必要があります。
ここから任務は危険になり始めます。ここからは、一つのミスステップが深刻な結果を招く可能性があります。捕まることを意味するからです。もし我々がジェームズ・ボンドなら、今ここで準備を整えて行動準備が完了している状態です。
NSA: それで、インターネットに面しているボックスがどれかを特定しました。彼らが使っているウェブサーバーはパッチが当たっておらず、更新されていなかったため、
既知のエクスプロイトを使ってそのマシンに適切にアクセスすることができました。[音楽] それができたら、そのマシンにインプラントを仕込みました。なぜなら、それは非常に安全だからです。
それは実際にはLinuxサーバーであり、Linuxの良い点はアンチウイルスがないことです。だから私はあまり心配していません。特にそれがウェブサーバーだからです。
画面を見て何かおかしなことが起きているのをユーザーが見る心配もありません。でもとにかく、そのボックスにアクセスして少し様子を見ました。すべて問題なさそうです。見るべきものはあまりありません。
それはウェブサーバーで、ウェブサイトがあり、データベースのバックエンドがあります。大きな動きはありません。
ジャック: 現在、我々は外国政府のネットワークに侵入しています。無事に侵入しました。建物に忍び込んだものの、まだ廊下にいるようなものです。
過去数ヶ月にわたって収集したデータを使用して、管理者のコンピュータを探し出してそれを制御しなければならないことがわかっています。
これがサイバーキルチェーンの次のフェーズ、すなわちエクスプロイト（攻撃実行）につながります。なぜなら、管理者のコンピュータを手に入れることができれば、すべての権限を得られる可能性が高いからです。
管理者のマシンを使うことで、欲しいものには何でもアクセスできます。
NSA: そのようなサーバーに到達する良い点は、管理者がログインして管理するサーバーであることです。その管理者がログインしてくるので、彼の資格情報を捕らえられる可能性が高いか
、または、サーバー（この場合はウェブサーバー）と管理者のマシンとの間に確立された認証済みセッションを横断して、管理者のマシンに横方向に移動できるでしょう。
さまざまな方法がありますが、要するに、彼が管理用にログインするので彼の資格情報を捕らえるか、認証済みのセッションを使って横方向に移動するのです。この場合の良い点は、その管理者を知っていたことです。
先述のとおり、我々は1カ月にわたってオープンソースの調査を行いました。ウェブサーバーを攻撃する予定だったので、ウェブサイトの管理者が誰であるか、
ネットワーク内のウェブサイトやその背後にあるデータベース、関連するすべてのコードの維持を担当するチームを知っていました。我々はこれらの人々をすべて把握していました。ウェブ開発者は最悪です。
IT系の人々はインターネットにたくさんの情報を投稿します。セキュリティ系の人は少し控えめですが、開発者やウェブ管理者はどんなことでもインターネットに投稿します。
それは驚くべきことです。私たちは彼ら全員とそのコンテンツを見つけ出し、名前で把握していました。ウェブサイトに関連する全員の写真も手に入れました。彼ら全員を知っていました。
素晴らしかったのは、ウェブサーバーをエクスプロイトしたあと、管理するためにログインしてくるのが三人のうちの一人であることをほぼ確信していたことです。
計画は、その三人のうちの誰かがログインするのを待つだけでした。彼らがどのようにログインするのかも知っていると思っていました。なぜなら、彼らが導入しているシステムに詳しかったからです。
我々は、ウェブサーバーの設定から、彼らがどのようにそのマシンにログインするか期待できることを知っていました。本当に、それは私たちにとって待ちゲームになりました。
ジャック: 管理者がログインするのを待つことは、時間がかかることがあります。日、週、月単位で待つこともあります。ハッカーが行うトリックの一つとして、ウェブサーバーにCPUを急上昇させたり、
アプリケーションをクラッシュさせたりする問題を意図的に引き起こすことがあります。なぜこんなことをするのでしょうか？ウェブサーバーに問題が発生すれば、管理者がログインしてトラブルシューティングを行うことになるからです。
その瞬間、[00:21:00] 彼らは罠にはまったことになります。しかし、我々の場合、待つ時間はそれほど長くはありませんでした。
NSA: ある管理者がログインしました。それを確認しました。[音楽] 必要な情報を取得し、彼のマシンに横方向に移動してそこにインプラントを配置しました。
ジャック: これでサイバーキルチェーンの第五フェーズである「インストール」を完了しました。ターゲットシステムにインプラントをインストールしました。
インプラントとは、バグ、トロイの木馬、リモートアクセスツールのことで、コンピュータをほぼ支配することを可能にします。Metasploitに詳しい方なら…
NSA: Metasploitを大量に強化したものを想像してください。
ジャック: サイバーキルチェーンの次のフェーズは「指令・制御」です。インプラントがマシンにインストールされても、それだけでは何も起こりません。誰かがインプラントに指示を出す必要があります。
この場合、ネットワーク管理者のコンピュータにリモートでアクセスする能力を得たことになります。これがターゲットコンピュータに対して我々の指令と制御となります。
我々は今、任務の完了に非常に近づいています。残っているのは、管理者のコンピュータを制御し、データベースにアクセスして必要なデータを取り出すことだけです。
そこで、管理者のコンピュータにアクセスする前に、怪しまれないよう少し待つことにします。
NSA: 約1日、1日半待ってから、インタラクティブにそのマシンを使用することにしました。実際にインタラクティブに使用する間、他の人が使用している時にログオンしましたが、基本的にこの方法が普通です。
デスクトップのスクリーンショットを見始め、ブラウザが開かれ、数十のタブが開いているのを見ました。たくさんのスクリーンショットを確認し、タブの内容を見ていました。
それは、その人物がWindowsの奇妙な挙動をGoogleで検索しているものでした。
ジャック: 我々が侵入した管理者のコンピュータが異常な動作をしていました。多くのエラーが表示され、特定のプログラムがクラッシュしていました。明らかにこの管理者のコンピュータには何らかのウイルスがあるように見えました。
NSA: 最初にそれを見たとき、奇妙だなと思いました。これらの問題は我々が侵入する前からあったのだろうかと考えました。はっきりとは分かりませんでしたが、我々と何か関係があるのではないかというひそかな疑念が湧きました。
当初の情報収集からインプラントを仕込むまでの間に、彼はオペレーティングシステムをアップグレードしていました。Windowsを次のバージョンにアップグレードしていたのです。
通常、最悪のケースは、何らかの理由でインプラントが互換性を持たず動作しないことです。それはそれで困りますが、実際はインプラントが正しくダウンし、インストールされ、期待通りに動作し始めました。
問題は、新しいWindowsバージョンとうまく互換性が取れず、奇妙な動作を引き起こし始めたことです。その奇妙な動作は、ユーザーに非常に見えやすい形で現れてしまいました。
我々はそのマシンに入り、そのWindowsバージョンを正確に知ることができたので、我々自身のラボ環境で再現しました。どのバージョンのWindowsであるか、どのハードウェアかを知っていたので、ほぼ同じ機械を環境内で再構築し、
インプラントを配置してみたところ、奇妙な動作がインプラントによって引き起こされていることがわかりました。これは本当に、本当に悪い知らせでした。これが捕まる原因になるのです。それは恐ろしいことでした。
政治的な反発の観点から見ると、このような事態の通知は政府の最高レベルにまで上がります。なぜなら、こうしたネットワークで捕まると、首相同士が電話をかけ合うことになるからです。
事態が十分に悪化すれば、機関の指導層を通じて、政府の上層部にまで報告する必要があります。[00:25:00] 皆がとても心配していました。我々はすでにウェブサーバーに侵入しており、かなりの作業を行っていたからです。
我々はかなり安心していたため、ネットワーク上に非常に洗練された大きなインプラントをすでに配備していました。問題を引き起こしていたこのインプラントは、初期段階のローダーではありませんでした。
これは比較的洗練されていて、事実上非常に高度な多機能インプラントであり、失うわけにはいかず、ネットワーク上で捕まるわけにもいきませんでした。[音楽] 
何が起こっているのかを理解すると、政府機関としてのすべてのアラームが鳴り始め、たくさんの人に知らせ始め、多くのメモを書き、多くの会議に出席して、何が起こっているのか、
リスクは何か、何をするつもりなのかを皆に伝えなければなりませんでした。当然ながら、最初の本能的な反応はインプラントを削除するか取り除くことです。しかし、すでに多くの安定性の問題を引き起こしていたため、
削除しようとするとさらに悪化するのではないかと懸念しました。何が起こるかわからず、そのリスクは取らないほうがいいという判断になりました。現時点では、彼は技術的な問題があると思っているだけで、
セキュリティの問題だとは思っていないと考えていたので、まあいいかと。
リスクは、今の状態のまま放置して技術的な問題だと思わせ続けるか、彼が実際には技術的な問題ではなくセキュリティの問題であることを見抜く前に削除しようとするかのどちらかです。
しかし、削除しようとしてさらに別の奇妙な問題を引き起こす可能性もあり、それはさらに悪化させるかもしれません。そして完全に行き詰ってしまいます。私たちは削除せずにこの状態を維持することに決め、
その賭けに出ることにしました。約１週間は状況が悪化しました。彼が問題の解決策をGoogleで検索しているのを見ているだけでなく、Windowsで見ている症状をGoogleで検索しているのを見て、
彼のメールを読んだり、IT担当者とのチャットを見たりしていました。彼はそこで何が起きているのかを伝え、トラブルチケットを発行していました。
IT担当者とのやりとりでは、「2時に私の机に来て見てもらえますか？」というような会話が見られました。皆、この時点で非常に心配し始め、私たちもさらに心配になりました。
ジャック: この時点で事態はうまくいっておらず、オフィスは非常に緊張感が漂っています。使用しているインプラントは高価で秘密のものでした。
もし発見されれば、攻撃者にたどり着く可能性があり、この高価で秘密のインプラントを失うことになります。しかし、現時点でサイバーキルチェーンの7つのフェーズのうち6つを完了しました。
残るは1つのフェーズだけで、それは目標に対しての行動です。我々のケースでは、管理者のコンピュータを使ってOracleデータベースからデータを取り出すことが目標ですが、チームはその仕事を完了することに躊躇していました。
NSA: 問題は、ネットワークが大きく、探しているデータベースがどこにあるかわからないことでした。特定のタイプのデータベースにアクセスしたいことはわかっていましたが、ネットワーク上の正確な場所は不明でした。
この時点で、捕まるリスクが高まっています。問題は、彼らがトラブルシューティングしている様子を見ていて、このプロセスが進行していくうちに、
何か本当に問題があると感じ、セキュリティ担当者を呼んでさらに詳しく調べ始めるときです。最も避けたいのは、ネットワーク上での存在感を広げてしまうことです。
特に、もしインシデント対応チームが関与して一斉にロックダウンを始めた場合、こちらの位置が他のマシンに広がっていると危険です。
この時点では、アクセスを失うことなく、できる限り露出を最小限に抑えたいと考えました。現在、その最小化は問題のあるこのコンピュータとウェブサーバーにとどまっていました。
それが我々の立場でした。議論の余地もなく、非常に明確な決定は、ただ静かに待つことでした。誰もが、どういう結果になるかがわかるまでリスクを高めたくないと思っていたのです。
ジャック: チームは待って、様子を見続けます。何日も過ぎていきます。管理者たちは、見ているエラーのトラブルシューティングを試みています。
1週間が過ぎ、彼はトラブルシューティングを続け、2週目にはIT部門に助けを求めました。
NSA: そうですね、2週目にはITの人々がやって来てコンピュータを見ていました。彼らがその管理者の席に行く手はずになっているのを確認しています。トラブルチケットの性質から、どうやら彼らは行き詰まっていることがわかります。
どうしてそんなことが起こるのかわからず、何が起こっているのかもわからず、その理由を解明できていません。原因を特定できず、彼らには不確定性があるように思えます。我々はなぜそれが起こっているのか知っています。
インプラントが何をしているのか、そのせいでWindowsがあのように動作している理由を理解しています。しかし、彼らはインプラントの存在を知らないため、その動作は完全に不確定に見え、
それを解決する技術的な方法を考え出すことができませんでした。
彼らがたどり着いた最終的な解決策は、[00:30:00] ドライブを完全に消去してやり直すことでした。インプラントは高機能でしたが、ユーザーレベルでハードドライブに存在していたので、
彼らがドライブを消去して再イメージした瞬間、問題は解決しました。彼らがインプラントを削除したため、我々は問題なかったのです。それは大きな安堵でした。終わったんだ、でもみんなクビになるんじゃないか、と思いました。
それは誰もが職場でひどく事態が悪化した時の当然の反応ですよね。結局のところ、事態が悪化したそのグループの責任者は私だったのです。その瞬間、デスクを整理して退職するのかなと思いました。
しかし、a) ここは政府なので誰もクビにはなりませんし、b) 実際にはそうはなりませんでした。[音楽] この後、私たちは何が起こったのか、どうして起こったのかを見直し、どうやって防ぐかのための事後分析を行いました。
事後的な判断としては、怠慢はなかったということでした。誰も何か間違ったことをしたわけではありません。ただそれが起きたということです。
2ヶ月の調査の後、30日をかけて決断を下し会合を持ち、その30日間に作戦を実行した際、管理者の一人がWindowsをアップグレードしたという事態はあまり高い確率で発生することではありませんでした。
ただ運が悪かっただけです。残念なことに、それが偶然同時に起きてしまいました。もしそれが6ヶ月かかったとして、情報を再取得して新しくし直さなかった場合、結果として、「待ちすぎたね」と言われたでしょう。
それは当然です。6ヶ月で多くのことが変わります。しかし30日というのは合理的です。なぜなら、政府ですから。書類手続きや会合、必要な事務作業をするのに30日かかるのです。
30日でその事が起きたこと、その人がWindowsのパソコンを更新したことは受け入れるべきこととされました。
唯一の他の影響は、別のマシンに横移動する際に、インプラントを配置する前に何か戦術的に行うべきだったかという議論があったことです。
資格情報を取得し、そのマシンと対話的にやりとりし、OSやアンチウイルスなどを確認するべきだったのでしょうか。これはその時点での作戦上の決定、非常に戦術的な決定でした。
しかし、オープンソースの調査をしてそこに何があるかを知っていたからこそ、それを行う理由が少なかったように思われます。それが全てです。
ジャック: インプラントがマシンから取り除かれたことで、チームは安心して、自分たちの存在が露見することや高価なエクスプロイトが発見されることがないと知って落ち着くことができます。
しかし、データベースへのアクセスを得るという当初の目的はどうなったのでしょうか？
NSA: 実際、我々はデータベースへのアクセスを得ることはありませんでした。これが原因というわけでもなく、ネットワークが構成されていたため、現在地から目的地までの道筋が非常に複雑だったのです。
多くの企業環境と同様に、我々には競合する要求がありました。この小さな事件からおそらく1ヶ月半後に、Oracleサーバーの場所と管理者はわかったのですが、そこに到達するのが複雑で、時間がかかると判明しました。
しかし、他の3つの要求を満たす必要があり、それに関わる人数も不足していましたので、どうしようかと考えました。結局、作業を打ち切って手を引くか、全力で取り組むかを決める時が来ました。
結局、作業を打ち切って引き下がることにしました。これはよくあることです。国のABTに所属するハッカーであれ、母親の家の地下室にいる子供であれ、誰もが知っていることですが、世の中がうまくいくのはかなり運に左右されます。
考えや知識だけでなく、最終的には多くの運が関わってきます。長年の経験から言って、統計的には運が尽きるか、存在しないことが多いです。
なぜなら、サイバーセキュリティや情報セキュリティに対する意識が一般に高まっているからです。例えば、不用意にリンクをクリックしないことや、職場のコンピュータから特定のウェブサイトにアクセスしないこと、
Flashの更新を求められても「OK」を押さないことなど、賢くなった人々が増えつつあるので、毎日少しずつ難しくなっています。
