[INTRO MUSIC]
ジャック: ゼロデイをいくつ見つけましたか？
カイル: そんなに重要じゃないです。具体的な数は覚えていませんが、多分100以上はあると思います。
ジャック: 100個のゼロデイを見つけたと考えているのですか？
カイル: そうですね、ゼロデイとして数えられるかは分かりません。
つまり、確かにそれらは以前には見つかっていなかった、少なくとも公開されていなかったもので、時には一つのアプリケーションに3つか4つの公開されていない問題が含まれていることもあります。
私は特にすごいハッカーというわけではありませんが、まぁそういう感じです。誰にでもできることです。ただ少しの練習と強い決意が必要なだけです。
ジャック (INTRO): これはDarknet Diaries、インターネットの暗黒面からの真実の物語です。私はジャック・リーサイダーです。
ジャック: 家はプライベートで個人的なものです。家は安全で安心できる場所です。
家は守られ、親密な場所です。私たちは他人が単に家に入ってきて、銀行の明細書や写真のような私たちのもっともプライベートなものを持ち去ることを許しません。
ドアがロックされているか、窓が閉まっているかを知っています。それが他人を外に置いておくことを知っているわけですが、時には他の方法で他人が家に入ってきて私たちの最も貴重なものを持ち去ることがあるのです。
これらの他人は、数千マイル離れたところからでもそれを行うことができます。
カイル: 私の名前はカイル・ラヴェットです。今はVeracodeのシニアペネトレーションテスターをしています。
ジャック: カイルの日中の仕事はペネトレーションテストです。彼は、ハッカーがネットワークに侵入できる方法がないかどうかを確認するために、企業のセキュリティをテストする事をしています。
しかし、このストーリーはその話ではありません。このストーリーは、2013年にカイルが自宅用に新しいルーターを購入したときの話です。
カイル: ええ、新しいAsusのN66ルーターを見ていました。
ジャック: カイルの友人が新しいAsus N66ホームルーターを持っていて、カイルにそれを勧めました。これは安いルーターではありませんでした。300ドルを超える高級機種の一つでした。
カイル: それらは市場で最も人気のあるルーター、もしくは少なくともそのうちの一つでした。誰もそのハードウェアが非常に優れていることを否定できませんでした。
特にIT関係者の間で非常に人気がありました。多くのIT系の人々が自宅にそれを持っていました。
ジャック: カイルはそれを購入して家に持ち帰りました。
カイル: 家に帰って実際の商品を探してみたとき、何か少し奇妙な感じがしました。
ジャック: 新しいルーターを設定しているとき、デフォルトで多くの機能が有効になっていることに気づきました。あまりにも多くの機能が。
カイル: VPNがインストールされていて、FTPサーバーがインストールされていて、ネットワーク内部でのファイル共有のためのSambaもありました。それに、その上でいくつかの異なるウェブサーバーも動いていました。
私はこれが安全なはずがないと思いました。そんなことがあるはずがない。このルーターには何か問題があるはずだと。あまりにも多すぎです。良すぎて本当ではないような感じでした。
ジャック: 最初に彼が気づいたのは、デフォルトのユーザー名が「admin」で、デフォルトのパスワードも「admin」であることでした。パスワードを変更するよう促されることはありませんでした。
このデバイスを所有している多くの人々は、おそらくパスワードを変更せず、admin/adminのままにしているでしょう。
こういった弱いデフォルト設定は、しばしばカイルを苛立たせます。彼はデフォルトのパスワードを変更し、新しいルーターの設定を続けました。
カイル: 普通のウェブアプリのペンテストのようにいじり始めました。ポート80には管理インターフェースがあり、ポート443にはAIクラウド、つまりクラウドインターフェースがありました。私はそこに注目しました。
ジャック: 彼が有効にした機能の一つはFTPサーバーでした。彼はルーターに外付けハードドライブを接続し、FTPサーバーを有効にしました。
この機能により、ルーターはネットワークストレージデバイスに変わります。
これによりユーザーはバックアップファイルや音楽コレクション、個人の写真、過去の税務記録など、外付けハードドライブに入れるものを保存できるようになります。
カイル: 私の興味を引いたのは、いつものようにFTPをオンにしたときに、自分のIPアドレスをスキャンしたときのことでした。ポート21が匿名アクセスで開いていることに気づきました。
それを見て、「おっと！ちょっと待ってくれ。」と思いました。
ジャック: [MUSIC] 彼が発見したのは、自宅内でルーターを通して個人の写真にアクセスできるだけでなく、そのルーターがインターネット上で公開IPアドレスを持っていたため、彼のデータを世界中に共有しているということでした。
さらに悪いことに、ファイルにアクセスするために必要なパスワードはありませんでした。
もしハッカーがこのルーターを持っていて、そこにハードドライブを接続していることを知っていれば、数千マイル離れた場所からでもそのハードドライブ上のすべてのファイルを閲覧できたのです。
カイル: ええ、私は外付けハードドライブの一つをルーターの後ろに接続していました。それが本当に私の興味を引きました。「ちょっと待ってくれ」と。
ジャック: 一度ルーターにセキュリティ上の問題を見つけたカイルは、他にも何か見つけられるかどうか、ペネトレーションテストのスキルを使い始めました。
カイル: 私がしたことは、ただ探索し始めて、ファズテストしてみたことです。でも実際にはそんなに多くをファズする必要はありませんでした。ファイルパスがすべてそのままそこにあったのです。何を見ているのかが分かりました。
ジャック: 数個の簡単なツールを使用して、ディレクトリ構造や特定のファイルが保存されている場所を見つけました。彼が見つけたファイルの一つには、ルーターそのもののユーザー名とパスワードが含まれていました。
これで彼が驚いたのは、パスワードがただの平文のファイルにクリアテキストで保存されていたことです。
カイル: ブラウザを開いて、ブラウザ上でHTTPSのIPアドレス/smb/tmp/lightepにアクセスするだけで、私が使っていたウェブサーバーの名前が表示され、権限設定がわかります。
そうすると、テキストファイルが生成され、その中にadminと、そのパスワード（デフォルトのパスワードを変更していなければadmin/admin）が記載されているのです。
それを見つけるのにかかった時間は、テスト開始からほんの20分、25分くらいでした。それも本格的なファズテストや、スマートなファズテスト、脆弱性のチェックをすることなくです。
ジャック: つまり、彼の家の中にいるどんなゲストでも容易にカイルのルーターのパスワードを見つけることができるということです。
普通のブラウザを使ってURLにアクセスすれば、彼のパスワードが見えます。これを見るのに認証は必要ありませんでしたが、カイルはこれについてさらに考えました。
カイル: 待って、待って。ポート443が開いているときに外部からアクセスできるのか？ AIクラウドサービスを有効にしていたので、それは彼ら独自のクラウドサービスで、iTunesや携帯電話の同期が可能です。
外部からもクリアテキストのパスワードでアクセスできました。それで、かなり遠くに住んでいる別の友人に電話し、彼にもルーターを持っていることを知っていたので、「見ていい？」と尋ねました。
そして案の定、彼のクリアテキストパスワードもすぐに取得できました。それは少し怖かったです。
ジャック: 彼は、このルーターのAIクラウド機能が有効になっていると、誰でも簡単にインターネット上でこのルーターのパスワードを見つけることができることに気づきました。
カイル: 実際に世界中のすべてのAsusルーターのリストを作成し、そのディレクトリ構造を使ってポート443が開いているルーターをすべて見つけることができたのです。
ジャック: 彼はこのルーターのセキュリティにますます不安を感じていました。最新のパッチとアップデートを適用しても、これらのセキュリティ問題が残っていました。カイルはこれが既知のバグかどうかを調べ始めました。
カイル: そのルーターがどれほど人気があるか知っていたので、ちょっと怖くなりました。すぐにオンラインで他の誰かが発見していないか確認しました。
誰も発見していないことが分かると、「あ、やばい」と思いました。もう少し時間をかけたほうがいいと感じました。
ジャック: この時点で、カイルはこのルーターに見つけたセキュリティ欠陥の長いリストを持っていました。これらの問題は…
カイル: クリアテキストのパスワードが保護されていないディレクトリ構造にありました。FTPの問題やネットワーク内でのファイル共有のためのSambaなど、これも私の発見のひとつでした。
そして、デフォルトのパスワードadmin/adminの大きな問題もありました。
ジャック: ルーターにはVPNも内蔵されており、これらの脆弱性を組み合わせることで、攻撃者はまるで自宅のWiFiを使っているかのように家庭内ネットワーク全体にアクセスできるようになります。
カイル: 少なくとも不安を感じざるを得ませんでした。
ジャック: このルーターを持っている人は、非常に安全でない家庭ネットワークを持っていることが明らかになりました。カイルはShodanというウェブサイトを使って、この問題の規模を理解しようとしました。
Shodanはインターネット全体をスキャンし、どのIPが稼働しているか、どのポートが開いているかを確認するサイトです。また、これらのIPで動いているシステムの種類も取得しようとします。
カイルは、少なくとも50,000人が脆弱なFTPサーバーを実行していることを発見しました。
カイル: 脆弱なのは50,000から70,000程度で、これはFTPのみに対するものでした。ポート443や、ポート80のデフォルトパスワードについて話すと、その数の2～3倍はあるでしょう。
さらに困ったことは、攻撃者がこれを利用して、悪意のあるファイルを共有またはダウンロードするための「ワンストップショップ」にできることです。
トレントダウンロード用の小さなプログラムまで付属していました。そして、これらのユーザー、エンドユーザーが誰であるにせよ、そのVPNを利用して、オンラインでの攻撃や悪意ある行為をプロキシのように行うことができるのです。
ジャック: カイルはこの問題の大きさを理解し始めていました。彼が購入した高級で高価なルーターには、ベンダーにまだ知られていない、または公に議論されていない明白なセキュリティ上の欠陥やバグが満載でした。
これにより、10万人以上の人々が自宅での攻撃に対して脆弱になっていました。攻撃には、ファイルの奪取、内部コンピュータへのアクセス、ユーザーのルーターの制御、または他のシステムに対する攻撃の実行が含まれます。
カイル: エンドユーザーは、ルーターがダウンし始めるまで、自分に何が起こっているのかを知ることはまずないでしょう。
ジャック: ソフトウェアにセキュリティバグがあり、ベンダーが問題に気付いていない場合、これをゼロデイ脆弱性と呼びます。ゼロデイというのは、ベンダーがその問題を認識してからの日数がゼロ日であることから来ています。
ベンダーが問題を認識すると、それはもはやゼロデイではなくなり、ベンダーは修正をリリースするために作業を進めることができます。さて、カイルの立場になって考えてみてください。
非常に人気のある家庭用ルーターで多数の未修正のバグを見つけたところです。このバグにより、世界中の10万軒以上の家庭のプライベートネットワークにアクセスできます。
家庭用ネットワークに簡単に侵入できるだけでなく、彼らのすべてのファイルを見たり、彼らのルーターをプロキシとして利用することもできます。
あなたがこのような知識と能力を持っていたら、どうしますか？皆のファイルを見て回って何があるか調べますか？ダークマーケットでこれらのエクスプロイトをビットコインで売ろうとしますか？
このような状況に置かれたら、どのように感じますか？
カイル: この明白な脆弱性を持つものを買ってしまったことに、少し怒りを感じていました。
私はすぐにAsusに連絡を取りたかったし、彼らの情報セキュリティグループや、セキュリティを担当するチームにすぐに修正するよう促したかったです。なぜなら、これは決して少数の人々のみに影響を与えるものではなかったからです。
ジャック: カイルにとって、選択は簡単でした。彼は他人のファイルを見たり、この知識を何か悪意のある目的で利用したりすることは一度もありませんでした。
ただ、何千人もの人々のセキュリティを向上させるために、このバグを修正してもらいたかったのです。実際、彼自身もカスタマーであり、自分のルーターのバグを修正してもらいたかったのです。
彼はこのルーターを製造したAsusに連絡する方法を探し始めました。
カイル: 確か最初のメールを送ったのは2月か3月あたりでした。それまでに公表手段を取ったことはあまりなく、何かを見つけたときは、通常は匿名での連絡をしていました。
それを1ヶ月ほど続けたのですが、匿名のメールアカウントには何の返答もありませんでした。そこで、偽名を使うのをやめて、自分の本名と本当のメールアドレスを使おうと決めました。それほど重要なことだからです。
ジャック: カイルは実名で再度Asusにメールを送りました。3週間が経ちましたが、Asusからの反応はありません。そのため、5月にもう一度メールを送ることにしました。
カイル: 彼らは反応しました。「分かりました。確認します。」と言いました。
ジャック: やっと返事が来て、カイルは多少ほっとしましたが、修正がリリースされるまでは満足しませんでした。彼はさらに2週間待ちましたが、これで彼が最初に問題を報告してから2ヶ月になります。
それでもバグの修正や、顧客にこの問題が存在することを知らせるプレスリリースはありません。実際、Asusはまだ問題を確認したとも言っていません。カイルは彼らに対して苛立ちを感じ始めていました。
カイル: さらにメールを送り、その後も数通のメールを送りました。彼らをしつこく追い詰めるつもりではありませんでした。ただ、彼らに「はい、これは脆弱性であることを確認しました」と言ってもらいたかっただけです。
そうすれば、そのことを忘れて次に進むことができるからです。約1か月後、私はオンラインでの部分的な公開に踏み切ることを決めました。
顧客に警告を出さず、人々がただこのルーターを買いに行く状況を変えるために、彼らにもっと早く動いてもらいたかったのです。
ジャック: カイルが決断したのは、誰でも見られるようにオンラインでバグを公開することでした。これは難しい決断でした。
一方では、彼は顧客に対して、ルーターにバグがあり、それが他人にルーターへのアクセスやドライブへの接続を許してしまうことを知らせていますが、他方では、ハッカーに対して何千人もの家庭に侵入するための鍵を渡すことになります。
カイル: 独立した個人研究者として知っていることですが、私の声にはあまり重みがありません。
ですから、個人的に何かを発見して、それに対してベンダーが修正しようとしない場合や無関心である場合、私たちが本当に自由に使える唯一の手段は、彼らに恥をかかせることです。
恥をかかせてバグを修正させることです。不幸にも、彼らに恥をかかせることは時々、それが本当にバグであることの証明を示すことを意味します。
それが証拠とコンセプトです。はい、悪意のある人々もこの証拠を目にすることになるとわかっていますが、いくつかのベンダーは、PRに影響が出るまで気にしないのです。
PRに影響が出て、悪い報道があり、彼らがバグのあるアプリケーションやルーター、スイッチを持っていることが広まったとき、ようやく修正に動き出します。
これは私たちにとって危険な行動です。これまでに訴訟の脅迫を受けたこともあります。何かを公開したことで、人々がそれを利用してしまうかもしれないと知ることは、気持ちの良いことではありません。
しかし、私は妻や他の何人かに言いましたが、私はソフトウェアアプリケーションを壊しているのではなく、すでに壊れている場所を指摘しているだけです。
ジャック: セキュリティ脆弱性を一般に公開するというコンセプトは、フルディスクロージャーと呼ばれます。
このトピックはセキュリティコミュニティでしばしば議論されています。カイルは彼のすべての発見を公に共有することには慎重でしたが。
カイル: 私は部分的な公開を行い、詳細には入らず、それが何を引き起こす可能性があるかを伝えました。FTPの問題については簡単に触れましたが、深くは掘り下げませんでした。
ジャック: そしてカイルはAsusの反応を見守りました。さらに3週間が過ぎました。彼が最初にこれを伝えてから4か月が経過してもまだ彼らはこれが欠陥であると認めたことさえありません。カイルは次のステップに進むことを決めました。
カイル: その時、クリアテキストのパスワードについての通知を出しました。それが広まり、いくつかのメディアアウトレットがそれを拾い上げ、そこから一気に広まりました。
FTPのことは言及しませんでした。それは、突然その7万人を危険にさらすような流れを作るのは本当にダメージが大きいと思ったからです。
フルディスクロージャーは本来すべてを公開すべきだと思いますが、今となっては少し異なる方法を選んだかもしれません。
ジャック: [MUSIC] セキュリティブログ、ウェブサイト、ニュースアウトレットはカイルの公開に注目し、その明白なセキュリティ欠陥について記事を書き始めました。
彼らはこの問題がどれほど深刻であるかをはっきりと伝えることができたのです。顧客は怒り始め、Asusに問題を修正するよう要求しました。
カイル: これによって少なくともいくつかの問題が修正されましたが、FTPの問題は8月から9月にかけて修正されずに残りました。
ジャック: そこでカイルは再びメールを送りました。今回は、AsusはカイルをPR担当者とつなげ、その人は開発者の担当窓口でもありました。
カイル: 彼は「わかりました。確認しますが、これは設計によるものです」と言いました。これは設計上のものであると。「無限の共有」と私も冗談ではなく呼ぶのです。
これは無限の共有だと。アップセルか何かということで、全員と共有できるようになっているということでした。私は「全員と？本当にハードドライブ上のすべてのものをその人たちと共有できるんですか？」と言いました。
ジャック: この回答はカイルを満足させませんでした。
カイル: 「なんだって？まさか、さすがにそれはないだろう」と思いました。しかし、その時点で私はそれ以上追求しませんでした。彼らはそれについて知っていましたが、時には本当に何もできないことがあります。
ジャック: 10月が過ぎ、11月が過ぎ、12月と1月も過ぎました。この時点で、カイルが見つけたすべてのバグは公然の知識となっていました。彼が言及した手がかりの一部と、Asusへの注目が高まったことが原因です。
彼が見つけた脆弱性は、10種類の異なるAsusルーターモデルに存在しました。この脆弱性の情報はインターネット上に広がり続けました。
望まれない他人が今や人々のファイルを探し求めるようになっていました。この時点で、すべてのAsus FTPサーバーが複数の他人によってアクセスされた可能性が高いです。
彼らはファイルを見て、興味を引くものを持ち去ったり、またスタッシュポイントとしてファイルをアップロードしたりしたでしょう。
ある未知のグループが自ら行動を起こそうとしました。彼らはインターネット上でスキャンを行い、すべての脆弱なAsusルーターを探し出し、匿名のFTPサーバーを実行している1万以上のIPを見つけました。
彼らはそれらのルーターにアクセスし、メッセージを残しました。それには、
「警告。あなたは脆弱です。これは影響を受けたすべての人に送られた自動メッセージです。あなたのAsusルーターとあなたの文書は、インターネット接続を持つ誰にでもアクセス可能です。
解決策：FTPとAI Cloudを完全に無効化してください。」
と書かれていました。メッセージは/Gと署名されていました。これは、4Chanの技術掲示板から発信された可能性があり、彼らは/Gという名前を使っています。メッセージでは、このインシデントをASUSGATEと呼んでいました。
被害者としての気持ちを理解してみましょう。夜、あなたの素敵で居心地の良い、安全で暖かいベッドで寝て、安心して夜を過ごすことを想像してください。
目が覚めて、バスルームに行き、トイレを使い、鏡を見ると、あなたの家のドアが8カ月間開いていて、誰でも入って来られると書かれたメモがあることに気づきます。
誰かがあなたのルーターの中に入ってファイルを見ていたことに気づいたときの不気味さは、言葉では説明できません。それは侵害されたという感覚であり、非常に恐ろしいものです。
Asusの顧客は、自分のハードドライブやファイルにアクセスされたことに激怒しました。さて、FTPサーバーにパスワードが設定されていなかったため、そのアクセスが違法かどうかは疑問が残ります。
アクセスを制限するものがない場合、一部の法律ではそれを合法とされています。ハッカーたちはファイルにアクセスするために特別なツールや、バイパス、ハック、トリックを使ったわけではありません。
標準のFTPクライアントを使用し、彼らが行ったことにパスワードは必要ありませんでした。Asusがこれをセキュリティバグではなく機能と称したため、なおさらこの行為が犯罪ではない可能性が高いのです。
カイル: それがきっかけでAsusはまた動き出しましたが、まるで私がそれをやったかのようにAsusは私に連絡してきました。実際、何人かの人は「なぜそんなことをしたの？」と言ってきました。私は「そんなことはしていません。他のグループがやったんです」と言いました。彼らは善意のつもりだったのでしょう。彼らはただFTPにテキストファイルを置いただけですが、もし私がやるとしたら、あんな方法は取らなかったでしょう。
ジャック: ハッカーたちが人々のルーターにメモをアップロードしたというニュースは、大手ニュースネットワークにも届きました。実際、カイルはこの状況を説明するためにCNNのインタビューを受けたこともあります。
彼はそのインタビューに緊張しており、ニュースがこれほど大きくなったことに驚いていました。
カイル: 公に初めての公開でかなり大きな影響を与え、少し不安になりました。
ジャック: 最終的に、Asusはカイルが報告したすべてのバグを修正しましたが、その後、カイルは修正版にもさらに多くのバグを見つけて報告しました。最終的に、Asusはこれらの問題も解決しました。
数年後の2016年2月、米国連邦取引委員会（FTC）はAsusに対して訴訟を起こしました。FTCは、Asusが法律を破った可能性があると考えました。5か月後、判決が出されました。
FTCは、10,000人以上の顧客のデータが望まれない侵入者によってアクセスされたという証拠を見ました。FTCは、Asusがセキュリティ問題を適時に対処していないと述べました。
Asusはこの件で和解し、FTCが許可した以下の命令に従わなければならなくなりました：Asusはセキュリティの欠陥について顧客を誤解させてはいけません。
セキュリティアップデートが利用可能になったときには、公に顧客に明確に通知しなければいけません。製品に対してセキュリティ監査を行わなければいけません。
これには、ペネトレーションテスト、従業員のトレーニング、コードレビュー、リスクアセスメントなどが含まれます。セキュリティ監査はFTCに提出され、その実施を証明しなければいけません。
これらの命令に従わない場合、Asusは1件の違反につき16,000ドルの罰金が科されます。FTCの命令の中で最も厳しい部分は、次の20年間にわたって監査を継続することを求めていることです。
Asusは2036年までこれらの命令に従わなければいけません。[MUSIC]
カイル: 今日までに、未だに2千から3千件ほどの、古いファームウェアを持ち、それが全てのFTPとそのため背面に接続した全ての内蔵ハードドライブを、世界中に匿名でリダイレクトアクセスを可能にしている人々が存在します。
3年半も経ってからですか？Shodanを確認すれば、いまだにそのような人々がいることがわかります。これはかなり怖いことです。
ジャック: 数千人の人々が依然として脆弱なままです。というのも、彼らは単にルーターをパッチしていないからです。修正プログラムは利用可能ですが、彼らはそれを知らないか、興味がないかのどちらかです。
もしあなたがAsusのルーターを持っているなら、最新の状態に保ち、パッチを適用することは良い考えです。今では、セキュリティ研究者がベンダーと協力して問題を解決するための新しい方法があります。
一部の企業は、発見されたセキュリティバグに対して報奨金を提供しています。これらの報奨金により、研究者は一つの脆弱性を見つけることで数千ドルを稼ぐことができる場合があります。
ちなみに、カイルは報奨金を要求したこともなく、彼のAsusルーターに関する発見に対して報奨金を提供されたこともありませんでした。国土安全保障省には、米国コンピュータ緊急対応チーム（US-Cert）という部門があります。
カイル: US-Certは本当にその役割を強化しています。多くの人がUS-Certを通じてベンダーと連絡を取り、公開ディスクロージャーを行っています。
彼らが本当に役立ってくれるおかげで、もうほとんどフルディスクロージャーを行う必要がありません。私は大抵の場合、US-Certに行って「ここで助けてくれませんか？」と言えます。
私はこのベンダーとの交渉を試みているが、彼らは反応したがらないと伝え、DHSやMITREなどと協力してコミュニティのためにこうした作業を行っていることで、彼らの担当に任せることができるのです。
ジャック: カイル、今日あなたが使っている家庭用ルーターは何ですか？
カイル: ああ、今はXfinityを使っています。実際には2つのモデルがあります。100 MBのストリーミング用と通常サイズのストリーミング用のモデルです。
ただし、実際のファームウェアやルーターのハードウェア自体はCiscoが製造しており、私がそのCiscoに対して3つのゼロデイを報告しました。
ジャック: カイルがどこを見ても、家庭用ルーターやビジネスクラスのルーターにバグを見つけてしまうようですね。
カイル: 私はまだ、多くのベンダーにとってセキュリティが後回しにされていると思っています。その考え方が変わって、製品をテストするための優れたペンテスターを本気で採用するまで、こうした問題は続くでしょうね。
ジャック (OUTRO): [OUTRO MUSIC] ここまで、Darknet Diariesをお聞きいただきありがとうございました。ショーノートやリンクはdarknetdiaries.comをご覧ください。
音楽はIan Alex Mac、Kevin MacLeod、およびTabletop Audioによって提供されています。
[OUTRO MUSIC ENDS]
